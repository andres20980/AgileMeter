az group create --name AgileMeterResourceGroup --location francecentral

az aks create --resource-group AgileMeterResourceGroup --name AgileMeterCluster --enable-addons monitoring --kubernetes-version $version --generate-ssh-keys --location francecentral


##Cluster role Binding
kubectl create clusterrolebinding kubernetes-dashboard -n kube-system --clusterrole=cluster-admin --serviceaccount=kube-system:kubernetes-dashboard

##Get Credentials 
az aks get-credentials --resource-group AgileMeterRG --name AgileMeterCluster

##Browse AKS Kubernetes Dashboard
az aks browse --resource-group AgileMeterRG --name AgileMeterCluster --subscription "Evaluaci√≥n gratuita" --listen-port 8010



##Docker Secret

kubectl create secret docker-registry acr-auth --docker-server <acr-login-server> --docker-username <service-principal-ID> --docker-password <service-principal-password> --docker-email <email-address>

kubectl create secret docker-registry amapifront-regsecret --docker-server=amapifront.azurecr.io --docker-username=amapifront --docker-password=zZpndR1T1ZRoe=UwOg5aIiGSug9TS/CB --docker-email=alberto.muriel.devops@hotmail.com
kubectl create secret docker-registry amapiback-regsecret --docker-server=amapiback.azurecr.io --docker-username=amapiback --docker-password=4Xyy2uQT5vNP2B2lWWmtHDeKdnnhWZc= --docker-email=alberto.muriel.devops@hotmail.com
kubectl create secret docker-registry amapidatabase-regsecret --docker-server=amapidatabase.azurecr.io --docker-username=amapidatabase --docker-password=20WxT4a3CPeE99EqfZ6N6qOYBQPsg=dr --docker-email=alberto.muriel.devops@hotmail.com

##POD uses secret
https://github.com/andyzhangx/demo/tree/master/linux/secret#2-use-secret-to-pull-an-image-from-an-azure-private-registry
https://kubernetes.io/docs/tasks/configure-pod-container/pull-image-private-registry/



amapifront.azurecr.io
amapifront
zZpndR1T1ZRoe=UwOg5aIiGSug9TS/CB


amapiback.azurecr.io
amapiback
4Xyy2uQT5vNP2B2lWWmtHDeKdnnhWZc=


amapidatabase.azurecr.io
amapidatabase
20WxT4a3CPeE99EqfZ6N6qOYBQPsg=dr


 kubectl port-forward pod/agilemeterfront-7fcff755fb-4krgr 4200:4200