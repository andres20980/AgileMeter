<!--Secciones-->
<mat-accordion>
  <mat-expansion-panel class="section-expansion-table"
    *ngFor="let sectionConAsignacionesDto of lSectionConAsignacionesDto;">
    <mat-expansion-panel-header>
      <mat-panel-title>
        <div class="col-11">{{sectionConAsignacionesDto.nombre}}</div>
        <div class="col-1">
          <div *ngIf="sectionConAsignacionesDto.numNotas > 0" class="right-comment">
            <img class="" src="assets/comment_empty.png" title="Notas" />
            <p>{{sectionConAsignacionesDto.numNotas}}</p>
          </div>
        </div>
      </mat-panel-title>
    </mat-expansion-panel-header>

    <!-- Notas de la secciÃ³n -->
    <mat-form-field [floatLabel]="never" class="comments-form-field">
      <p><b>{{ 'SECTION_RESULTS.SECTION_NOTES' | translate }}</b></p>
      <textarea matInput cdkTextareaAutosize #autosize="cdkTextareaAutosize" cdkAutosizeMinRows="2"
        cdkAutosizeMaxRows="6" [ngModel]="DisplayNotes(sectionConAsignacionesDto.notas)" [readonly]="true">
      </textarea>
    </mat-form-field>

    <!--Lista de Modulos---------------------------->
    <mat-accordion>
      <ng-template matExpansionPanelContent>
        <mat-expansion-panel class="section-expansion-table mat-elevation-z0"
          *ngFor="let asignacionConPreguntaNivelDto of sectionConAsignacionesDto.asignaciones;">
          <mat-expansion-panel-header>
            <mat-panel-title>
              <div class="col-11">{{asignacionConPreguntaNivelDto.nombre}}</div>
              <div class="col-1">
                <div *ngIf="asignacionConPreguntaNivelDto.numNotas > 0" class="right-comment">
                  <img class="" src="assets/comment_empty.png" title="Notas" />
                  <p>{{asignacionConPreguntaNivelDto.numNotas}}</p>
                </div>
              </div>
            </mat-panel-title>
          </mat-expansion-panel-header>

          <!--Notas del modulo-->
          <mat-form-field [floatLabel]="never" class="comments-form-field">
            <p><b>{{ 'SECTION_RESULTS.MODULE_NOTES' | translate }}</b></p>
            <textarea matInput cdkTextareaAutosize #autosize="cdkTextareaAutosize" cdkAutosizeMinRows="2"
              cdkAutosizeMaxRows="6" [ngModel]="'' + DisplayNotes(asignacionConPreguntaNivelDto.notas)"
              [readonly]="true"></textarea>
          </mat-form-field>

          <!--Tabla de preguntas----------------------------------->
          <ng-template matExpansionPanelContent>
            <div class="table-row">
              <div>
                <table mat-table [dataSource]="asignacionConPreguntaNivelDto.preguntas" multiTemplateDataRows matSort
                  aria-label="Elements">
                  <!-- Pregunta  -->
                  <ng-container matColumnDef="pregunta">
                    <th mat-header-cell *matHeaderCellDef>{{ 'SECTION_RESULTS.QUESTION' | translate }}</th>
                    <td mat-cell *matCellDef="let row">{{row.pregunta}}</td>
                  </ng-container>

                  <!-- Respuesta -->
                  <ng-container matColumnDef="estado">
                    <th mat-header-cell *matHeaderCellDef>{{ 'SECTION_RESULTS.ANSWER' | translate }}</th>
                    <td mat-cell *matCellDef="let row">

                      <div *ngIf="!(isBinary) && !row.esHabilitante" style="display: flex; flex-flow: row">
                        <div [ngStyle]="{'backgroundColor': displayColorEstado(row), 'color': (row.estado == 0 ?'black':'white') , 'borderRadius': '20px', 'width': '30%', 'padding':'6px', 'textAlign': 'center'}">
                          {{displayRespuesta(row)}}
                        </div>
                        <i class="answerIcon" class="material-icons" [ngStyle]="{'color': '#FF3636', 'position': 'relative', 'display': 'block', 'opacity': displayFailed(row)}">feedback</i> 
                      </div>
                      <!--  'display': displayFailed(row) -->
                      <!-- solo para mostrar habilitantes -->
                     <div *ngIf="isBinary || row.esHabilitante">
                        {{displayRespuesta(row)}}
                        <img class="answerIcon" *ngIf="checkRespuestaCorrecta(row) == 'respuesta-correcta'"
                            src="assets/correct.png" title="{{ 'SECTION_RESULTS.ICONS_CORRECT' | translate }}" />
                          <img class="answerIcon" *ngIf="checkRespuestaCorrecta(row) == 'respuesta-incorrecta'"
                            src="assets/incorrect.png" title="{{ 'SECTION_RESULTS.ICONS_INCORRECT' | translate }}" />
                          <img class="answerIcon" *ngIf="checkRespuestaCorrecta(row) == 'respuesta-no-contestada'"
                            src="assets/incompleted.png" title="{{ 'SECTION_RESULTS.ICONS_NOT_ANSWERED' | translate }}" />
                      </div>

                    </td>
                  </ng-container>

                  <!--Notas de la pregunta-->
                  <ng-container matColumnDef="notas">
                    <th mat-header-cell *matHeaderCellDef>{{ 'SECTION_RESULTS.QUESTION_NOTES' | translate }}</th>
                    <td mat-cell *matCellDef="let row">
                      <div class="example-element-detail">

                        <div class="question-note">
                          <mat-form-field [floatLabel]="never" class="comments-form-field">
                            <textarea matInput cdkTextareaAutosize #autosize="cdkTextareaAutosize"
                              cdkAutosizeMinRows="2" cdkAutosizeMaxRows="6" [ngModel]="DisplayQuestionNote(row.notas)"
                              [readonly]="true">
                              </textarea>
                          </mat-form-field>
                        </div>
                      </div>
                    </td>

                  </ng-container>

                  <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                  <tr mat-row *matRowDef="let element; columns: displayedColumns;" class="example-element-row"
                    [class.example-expanded-row]="expandedElement === element"
                    (click)="expandedElement = (expandedElement == element ? null : element)">
                  </tr>
                </table>
              </div>
            </div>
          </ng-template>
          <!--Tabla de preguntas----------------------------------->

        </mat-expansion-panel>
      </ng-template>
    </mat-accordion>
    <!--Lista de Modulos---------------------------->
  </mat-expansion-panel>
</mat-accordion>